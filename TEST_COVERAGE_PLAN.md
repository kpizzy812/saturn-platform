# Saturn Platform - Test Coverage Plan

**Date:** 2026-02-11
**Current Coverage:** Backend 7.4% | Frontend 16.5%
**Target Coverage:** Backend 60%+ | Frontend 50%+

---

## Current State

### Backend (PHP/Laravel)

| Metric | Value |
|--------|-------|
| **Total Coverage** | **7.4%** |
| Unit Tests | 189 files, 2200 tests |
| Feature Tests | 47 files (run in Docker) |
| Models | 87 files |
| Jobs | 67 files |
| Actions | 86 files |
| Controllers | 59 files (+ 38 API) |
| Services | 94 files |
| Traits | 34 files |
| Policies | 27 files |
| Events | 33 files |

### Frontend (React/TypeScript)

| Metric | Value |
|--------|-------|
| **Total Coverage** | **16.5%** |
| Test Files | 66 files, 1367 tests |
| Pages | 207 files |
| Components | 103 files |
| Hooks | 37 files |
| Lib | 9 files |

---

## Backend: What Is Covered

### Well Covered (>50%)
- `Services/DockerImageParser` - 94.7%
- `Services/EnvExampleParser` - 97.1%
- `Services/RepositoryAnalyzer/Detectors/*` - 50-97%
- `Services/RepositoryAnalyzer/DTOs/*` - 50-100%
- `Services/TransferStrategyFactory` - 85%
- `Traits/HasSafeStringAttribute` - 100%
- `Traits/SshRetryable` - 65.6%
- `Services/MasterProxyConfigService` - 54.1%

### Existing Unit Tests (189 files)
<details>
<summary>Click to expand full list</summary>

- AIAnalysisResultTest
- AdminMiddlewareTest
- AiChatHealthStatusTest, AiModelPricingTest, AiPricingServiceTest
- AllExcludedContainersConsistencyTest
- AppDependencyDetectorTest, AppDetectorTest
- ApplicationAutogenerateDomainTest, ApplicationComposeEditorLoadTest
- ApplicationConfigurationChangeTest, ApplicationDeployment*Test (5 files)
- ApplicationGeneralPreviewTest, ApplicationGitSecurityTest
- ApplicationHealthcheckRemovalTest, ApplicationInternalUrlTest
- ApplicationNetworkAliasesSyncTest, ApplicationParser*Test (2 files)
- ApplicationPortDetectionTest, ApplicationServiceEnvironmentVariablesTest
- ApplicationSettingStaticCastTest, ApplicationWatchPathsTest
- AutoProvisionStartsProxyTest, AutoProvisioningEventTest
- BashEnvEscapingTest, BoardingPrerequisitesTest, BuildDefaultsTest
- CIConfigDetectorTest, ChatResponseTest
- CheckForUpdatesJobTest, CheckServerResourcesDiskTriggerTest
- CheckTraefikVersion*Test (2 files)
- CleanupDockerTest, ClickhouseOfficialImageMigrationTest
- CloneApplicationActionTest, CloneServiceActionTest
- CloudInitScriptValidationTest, CloudflareProtectionServiceTest
- CollectDatabaseMetricsJobTest, CommandExecutor*Test (2 files)
- CommandInjectionPreventionTest, CommandParserTest
- ConnectionStringParserTest, ContainerHealthStatusTest
- ContainerStatusAggregatorTest, CoolifyTaskCleanupTest
- CreateServiceActionsTest, CreateTransferActionTest
- DangerousFunctionsDetectorTest, DatabaseBackupSecurityTest
- DatabaseMetricTest, DatabaseMetricsControllerTest, DatabasePolicyTest
- DatalistComponentTest, DeleteUserResourcesTest, DependencyAnalyzerTest
- DeploymentApprovalNotificationTest, DeploymentExceptionTest
- DeploymentLogAnalyzerTest, DeploymentLogEntry*Test (2 files)
- DetectMissingEnvVarsTest, DockerCleanupExecutionTest
- DockerCompose*Test (5 files), DockerImage*Test (3 files)
- Dockerfile*Test (3 files), EmailChannelTest
- EnvExampleParserTest, EnvVarInputComponentTest
- EnvironmentPolicyTest, EnvironmentVariableAutocompleteTest
- ExcludeFromHealthCheckTest, ExecuteMigration*Test (2 files)
- FileStorageSecurityTest, Format*Test (2 files)
- GetContainersStatusServiceAggregationTest, GetDatabaseStructureActionTest
- GitAnalyzerControllerTest, GitLsRemoteParsingTest
- GlobalSearchNewImageQuickActionTest, HealthCheckDetectorTest
- Hetzner*Test (3 files), ImportCheckFileButtonTest
- InAppChannelUrlTest, IncidentTimelineServiceTest
- InfrastructureProvisionerTest, InfrastructureSettingsTest
- InstanceSettingsApplicationDefaultsTest, IntentResultTest
- LocalFileVolumeReadOnlyTest, LogViewerXssSecurityTest, LoginHistoryTest
- MasterProxyConfigServiceTest, MasterServerTest
- Migrate*Test (2 files), MigrationAuth*Test, MigrationDiffActionTest
- MonorepoDetectorTest, NixpacksNodeVersionInferenceTest
- NotificationOverviewTest, NotifyOutdatedTraefikServersJobTest
- Parse*Test (2 files), PathTraversalSecurityTest
- PermissionServiceTest, PortDetectorTest, PostgRESTDetectionTest
- PostgresqlInitScriptSecurityTest, PreMigrationCheckActionTest
- PreSaveValidationTest, PreviewDeploymentPortTest
- PrivateKeyPolicyTest, ProjectAuthorization*Test (2 files)
- ProjectSettingDefaultServerTest, PromoteResourceActionTest (2 files)
- ProxyConfiguration*Test, ProxyCustomCommandsTest, ProxyHelperTest
- RateLimitQueueSettingsTest, ResourceAuthorization*Test
- ResourceLinkAppTargetTest, ResourceTransferTest
- RestartCountTrackingTest, RestartProxyJobTest
- RestoreJobFinished*Test (3 files), RollbackMigrationActionTest
- S3Restore*Test (3 files), S3StoragePolicyTest, S3StorageTest
- SanitizeLogsForExportTest, ScheduledJob*Test (3 files)
- SecretsDetectorTest, ServerBulkSettingsValidationTest
- ServerManager*Test (2 files), ServerPolicyTest
- ServerQueryScopeTest, ServerSelectionServiceTest, ServerStatusAccessorTest
- Service*Test (8 files), SshKey*Test, SshMultiplexing*Test, SshRetry*Test
- StartProxyTest, StartupExecutionCleanupTest, StopProxyTest
- StripCoolifyCustomFieldsTest, SyncCloudflareRoutesJobTest
- TeamActivityApiTest, TeamWebhookTest, TimescaleDbDetectionTest
- ToolCallTest, ToolDefinitionsTest, Transfer*Test (2 files)
- Update*Test (2 files), UploadControllerSecurityTest
- User*Test (3 files), Validate*Test (7 files)
- Volume*Test (2 files), WebhookDeliveryTest, WindowsPathVolumeTest

</details>

### Existing Feature Tests (47 files, Docker-only)
<details>
<summary>Click to expand full list</summary>

- AdminUserBulkOperationsTest
- ApplicationBuildpackCleanupTest, BuildpackSwitchCleanupTest
- CheckTraefikVersionJobTest
- CleanupRedisTest, CloudInitScriptTest, CloudProviderTokenApiTest
- ConvertArraysTest, ConvertContainerEnvsToArray, ConvertingGitUrlsTest
- CoolifyTaskRetryTest, DatabaseBackup*Test (2 files)
- DatabaseMetricsApiTest, DeletesUserSessionsTest
- DeploymentApprovalWorkflowTest, DeploymentCancellationApiTest
- DockerCustomCommandsTest, EditDomainPortValidationTest
- EnvironmentVariableSharedSpacingTest, ExecuteContainerCommandTest
- GithubApps*Test (2 files), GithubSource*Test (2 files)
- Hetzner*Test (2 files), IpAllowlistTest, LoginRateLimitIPTest
- MultilineEnvironmentVariableTest, PrivateKeyStorageTest
- ProjectMembersAuthorizationTest, RestartProxyTest
- SentinelMetricsApiTest, SentinelUpdateCheckIndependenceTest
- ServerPatchCheckNotificationTest, ServerSetting*Test (2 files)
- ServerStorageCheckIndependenceTest, ServiceFqdnUpdatePathTest
- StartupExecutionCleanupTest, TeamInvitation*Test (2 files)
- TeamMemberProjectAccessTest, TeamPolicyTest, TeamSwitchTest
- TrustHostsMiddlewareTest, Utf8HandlingTest, WorkspaceSettingsTest

</details>

---

## Backend: What Needs Coverage

### Priority 1: Models (0% coverage, 87 files) - CRITICAL

Models contain core business logic. Most need Feature tests (Docker).

| Model | Priority | Complexity | Notes |
|-------|----------|------------|-------|
| **Application** | P0 | High | Core model, deployment logic, relationships |
| **Server** | P0 | High | SSH, Docker, proxy management |
| **Service** | P0 | High | Docker Compose parsing, multi-container |
| **Team** | P0 | Medium | Multi-tenancy, permissions |
| **User** | P0 | Medium | Auth, roles, superadmin |
| **Project** | P0 | Medium | Hierarchy, environments |
| **Environment** | P0 | Medium | Variable management |
| **EnvironmentVariable** | P0 | Medium | Encryption, scoping |
| **ApplicationDeploymentQueue** | P1 | High | Queue management, status tracking |
| **StandalonePostgresql** | P1 | Medium | DB lifecycle |
| **StandaloneMysql** | P1 | Medium | DB lifecycle |
| **StandaloneMongodb** | P1 | Medium | DB lifecycle |
| **StandaloneRedis** | P1 | Low | DB lifecycle |
| **StandaloneMariadb** | P1 | Medium | DB lifecycle |
| **StandaloneClickhouse** | P2 | Medium | DB lifecycle |
| **StandaloneDragonfly** | P2 | Low | DB lifecycle |
| **StandaloneKeydb** | P2 | Low | DB lifecycle |
| **PrivateKey** | P1 | Medium | SSH key management |
| **GithubApp** | P1 | Medium | OAuth, webhooks |
| **GitlabApp** | P1 | Medium | OAuth, webhooks |
| **S3Storage** | P1 | Medium | Backup storage |
| **ScheduledDatabaseBackup** | P1 | Medium | Backup scheduling |
| **InstanceSettings** | P1 | Low | Global config |
| **ApplicationSetting** | P1 | Low | App config |
| **ServerSetting** | P1 | Low | Server config |
| **ApplicationPreview** | P1 | Medium | PR previews |
| **Tag** | P2 | Low | Tagging system |
| **ResourceTransfer** | P2 | Medium | Cross-team transfers |
| **DeploymentApproval** | P2 | Medium | Approval workflow |
| **SslCertificate** | P2 | Medium | SSL management |
| **Permission** | P2 | Medium | RBAC |
| **PermissionSet** | P2 | Medium | RBAC |
| All others | P3 | Various | Notifications, audit, etc. |

### Priority 2: Jobs (0% coverage, 67 files) - CRITICAL

Jobs handle async operations. Most need Feature tests (Docker).

| Job | Priority | Complexity | Notes |
|-----|----------|------------|-------|
| **ApplicationDeploymentJob** | P0 | Very High | Core deployment pipeline |
| **ServerCheckJob** | P0 | High | Server health monitoring |
| **ServerManagerJob** | P0 | High | Server lifecycle |
| **DatabaseBackupJob** | P1 | High | Backup execution |
| **DatabaseRestoreJob** | P1 | High | Restore execution |
| **ValidateAndInstallServerJob** | P1 | High | Server provisioning |
| **DeleteResourceJob** | P1 | Medium | Resource cleanup |
| **DockerCleanupJob** | P1 | Medium | Docker cleanup |
| **ScheduledJobManager** | P1 | Medium | Cron scheduling |
| **ScheduledTaskJob** | P1 | Medium | Task execution |
| **RestartProxyJob** | P1 | Medium | Proxy restart |
| **DatabaseImportJob** | P1 | Medium | DB import |
| **AutoProvisionServerJob** | P2 | High | Auto-provision |
| **CollectDatabaseMetricsJob** | P2 | Medium | Metrics collection |
| **CheckAndStartSentinelJob** | P2 | Medium | Sentinel monitoring |
| **ResourceMonitoringManagerJob** | P2 | Medium | Resource monitoring |
| **Send*Job** (6 files) | P2 | Low | Notification dispatch |
| **ServerConnection*Job** | P2 | Medium | Connection checks |
| **Stripe*Job** (4 files) | P3 | Medium | Billing |
| All others | P3 | Various | Updates, cleanup, etc. |

### Priority 3: Actions (0% coverage, 86 files)

Actions contain business logic. Many can be unit-tested.

| Action | Priority | Can Unit Test? | Notes |
|--------|----------|----------------|-------|
| **CreatesApplication** | P0 | Partially | App creation flow |
| **CreateDockerComposeApplication** | P0 | Partially | Docker Compose apps |
| **CreateDockerfileApplication** | P0 | Partially | Dockerfile apps |
| **GenerateConfig** | P0 | Yes | Config generation |
| **GetContainersStatus** | P0 | Partially | Status aggregation |
| **InstallDocker** | P1 | No (SSH) | Docker installation |
| **InstallPrerequisites** | P1 | No (SSH) | Server setup |
| **ValidateServer** | P1 | No (SSH) | Server validation |
| **StartDatabase** / **StopDatabase** | P1 | No (Docker) | DB lifecycle |
| **StartService** / **StopService** | P1 | No (Docker) | Service lifecycle |
| **StartProxy** / **StopProxy** | P1 | Partially | Already partially tested |
| **CheckProxy** | P1 | No (SSH) | Proxy checks |
| **DeleteServer** | P1 | Feature | Server deletion |
| **DeleteService** | P1 | Feature | Service deletion |
| **CloneApplicationAction** | P1 | Already tested | - |
| **CloneServiceAction** | P1 | Already tested | - |
| **TransferProject** | P2 | Feature | Project transfer |
| **RunRemoteProcess** | P2 | No (SSH) | Remote execution |
| All Start* (databases) | P2 | No (Docker) | 8 DB types |
| All others | P3 | Various | - |

### Priority 4: Controllers (0% coverage, 59 + 38 API)

Controllers need Feature tests. Focus on API controllers first.

| Controller | Priority | Notes |
|------------|----------|-------|
| **Api/ApplicationsController** | P0 | CRUD, deploy triggers |
| **Api/ServersController** | P0 | CRUD, validation |
| **Api/ServicesController** | P0 | CRUD, lifecycle |
| **Api/DatabasesController** | P0 | CRUD, all 8 types |
| **Api/ProjectController** | P1 | CRUD, environments |
| **Api/SecurityController** | P1 | Auth, 2FA |
| **Api/DeploymentApprovalController** | P1 | Approval workflow |
| **Api/TeamController** | P1 | Team management |
| **Api/NotificationsController** | P2 | Notification CRUD |
| **Api/ResourceTransferController** | P2 | Transfer flow |
| **Inertia/ApplicationController** | P2 | Page rendering |
| **Inertia/ServerController** | P2 | Page rendering |
| **Inertia/ServiceController** | P2 | Page rendering |
| All others | P3 | Various |

### Priority 5: Traits (0% coverage, 34 files)

| Trait | Priority | Can Unit Test? |
|-------|----------|----------------|
| **Deployment/* (13 traits)** | P0 | Partially (complex Docker/SSH) |
| **ExecuteRemoteCommand** | P1 | No (SSH) |
| **EnvironmentVariableProtection** | P1 | Yes |
| **EnvironmentVariableAnalyzer** | P1 | Yes |
| **ValidatesPublicPort** | P1 | Yes (partially tested) |
| **Auditable** | P2 | Feature |
| **HasConfiguration** | P2 | Yes |
| **FormatHelpers** | P2 | Yes |
| All others | P3 | Various |

### Priority 6: Policies (0% coverage, 27 files)

| Policy | Priority | Notes |
|--------|----------|-------|
| **ApplicationPolicy** | P1 | Already partially tested via other tests |
| **ServerPolicy** | P1 | Already partially tested |
| **ServicePolicy** | P1 | Needs tests |
| **DatabasePolicy** | P1 | Already tested |
| **ProjectPolicy** | P1 | Needs tests |
| **TeamPolicy** | P1 | Already partially tested |
| **EnvironmentPolicy** | P1 | Already tested |
| All others | P2 | Various |

---

## Frontend: What Is Covered

### Well Covered Pages
- Admin (20 tests), Dashboard, Applications (Create/Index/Show/Settings/Deployments/Logs/Previews)
- Databases (Create/Index/Query/Users/Logs), Projects (Show/Create)
- Servers (Create/Index/Show/Proxy/Sentinel/Terminal)
- Services (Create/Index/Settings/Show)
- Settings (Account/Security/Integrations/Notifications/Billing)
- Templates (Index/Categories)

### Covered Components
- UI: Badge, Button, Card, Dropdown, Input, Select, Spinner
- Features: CommandPalette, ContextMenu, LogsViewer, LocalSetupModal
- Canvas: ProjectCanvas, DatabaseNode, ServiceNode
- Databases: MongoDB/MySQL/PostgreSQL/Redis panels
- Layout: Header

### Covered Hooks
- useDatabases, useDeployments, useProjects, useRealtimeStatus, useServers, useServices

### Covered Lib
- validation, statusUtils

---

## Frontend: What Needs Coverage

### Priority 1: Pages (0% coverage) - 140+ files

| Page Group | Files | Priority | Notes |
|------------|-------|----------|-------|
| **Auth/** (Login, Register, etc.) | 12 | P0 | Authentication flows |
| **Boarding/Index** | 1 | P1 | Onboarding |
| **Applications/Settings/**** | 3 | P1 | Domains, Variables, Index |
| **Applications/Rollback/**** | 2 | P1 | Rollback flow |
| **Applications/Incidents** | 1 | P2 | Incident view |
| **Databases/Settings/**** | 2 | P1 | DB settings |
| **Databases/Backups** | 1 | P1 | Backup management |
| **Databases/Metrics** | 1 | P2 | Metrics view |
| **Databases/Overview** | 1 | P1 | DB overview |
| **Databases/Import** | 1 | P1 | DB import |
| **Databases/Tables** | 1 | P1 | Table browser |
| **Databases/Connections** | 1 | P1 | Connection strings |
| **Databases/Extensions** | 1 | P2 | PG extensions |
| **Servers/Settings/**** | 4 | P1 | General, Docker, Network, Index |
| **Servers/Cleanup/** | 1 | P2 | Docker cleanup |
| **Servers/Metrics/** | 1 | P2 | Server metrics |
| **Servers/LogDrains/** | 1 | P2 | Log drains |
| **Servers/PrivateKeys/** | 1 | P2 | SSH keys |
| **Servers/Destinations/** | 2 | P2 | Docker networks |
| **Servers/Resources/** | 1 | P2 | Resources list |
| **Services/** (missing) | 8 | P1 | BuildLogs, Deployments, Domains, HealthChecks, Logs, Metrics, Networking, Variables |
| **Services/Rollbacks** | 1 | P2 | Service rollbacks |
| **Services/Scaling** | 1 | P2 | Service scaling |
| **Services/Webhooks** | 1 | P2 | Webhooks |
| **Settings/Team/**** | 5 | P1 | Team management, invites |
| **Settings/Team/PermissionSets/**** | 4 | P1 | RBAC |
| **Settings/Members/Show** | 1 | P1 | Member details |
| **Settings/Notifications/**** | 7 | P2 | Discord, Email, Slack, Telegram, Pushover, Webhook, Index |
| **Settings/Tokens** | 1 | P1 | API tokens |
| **Settings/Workspace** | 1 | P2 | Workspace settings |
| **Settings/AuditLog** | 1 | P2 | Audit log |
| **Settings/Team** | 1 | P1 | Team settings |
| **Sources/**** | 8 | P2 | GitHub, GitLab, Bitbucket |
| **Storage/**** | 6 | P2 | S3 storage, backups, snapshots |
| **Tags/**** | 2 | P2 | Tag management |
| **Transfers/**** | 2 | P2 | Resource transfers |
| **Volumes/**** | 3 | P2 | Volume management |
| **SharedVariables/**** | 3 | P2 | Shared env vars |
| **Admin/** (subpages) | 40+ | P2 | Admin area |
| **Activity/**** | 3 | P3 | Activity views |
| **CronJobs/**** | 3 | P2 | Cron jobs |
| **Domains/**** | 4 | P2 | Domain management |
| **Deployments/**** | 3 | P2 | Deployment details |
| **Environments/**** | 3 | P2 | Environment config |
| **Observability/**** | 5 | P3 | Metrics, logs, traces |
| **CLI/**** | 2 | P3 | CLI integration |
| **Errors/**** | 4 | P3 | Error pages |
| **Demo/** | 1 | P3 | Demo |
| **SSL/**** | 2 | P3 | SSL management |
| **Approvals/** | 1 | P2 | Deployment approvals |
| **Notifications/**** | 3 | P2 | Notification center |
| **Integrations/** | 1 | P2 | Webhooks |

### Priority 2: Components (0% coverage)

| Component Group | Files | Priority |
|-----------------|-------|----------|
| **AiChat/**** | 8 | P3 |
| **animation/**** | 6 | P3 |
| **common/EmptyState, LoadingState** | 2 | P2 |
| **deployments/**** | 2 | P1 |
| **features/AIAnalysisCard** | 1 | P3 |
| **features/FilterBuilder** | 1 | P2 |
| **features/IncidentTimeline** | 1 | P2 |
| **features/Terminal** | 1 | P2 |
| **features/RollbackTimeline** | 1 | P2 |
| **features/SentinelWidget** | 1 | P2 |
| **features/TableDataViewer** | 1 | P2 |
| **features/DeploymentGraph** | 1 | P2 |
| **features/MonorepoAnalyzer** | 1 | P3 |
| **features/migration/**** | 7 | P2 |
| **features/Projects/Tabs/**** | 11 | P1 |
| **transfer/**** | 4 | P2 |
| **team/**** | 1 | P2 |
| **projects/RoleSelector** | 1 | P2 |
| **ui/Tabs** | 1 | P1 |
| **ui/Modal** | 1 | P1 |
| **ui/ConfirmationModal** | 1 | P1 |
| **ui/Toast** | 1 | P2 |
| **ui/Chart** | 1 | P2 |
| **ui/CommandPalette** | 1 | P2 |
| **ui/AdminCommandPalette** | 1 | P3 |
| **ui/SqlEditor** | 1 | P2 |
| Other UI | 8 | P2-P3 |

### Priority 3: Hooks (0% coverage)

| Hook | Priority | Notes |
|------|----------|-------|
| **useApplications** | P0 | Already tested |
| **useApplicationMetrics** | P1 | Metrics fetching |
| **useDatabaseDetails** | P1 | DB detail fetching |
| **useDatabaseSettings** | P1 | DB settings |
| **useDatabaseStructure** | P1 | Table/schema info |
| **useDatabaseMetrics** | P2 | DB metrics |
| **useDeploymentAnalysis** | P2 | AI analysis |
| **useGitBranches** | P1 | Branch selection |
| **useLogStream** | P1 | Log streaming |
| **useTerminal** | P2 | Terminal session |
| **useMigrations** | P2 | Migration management |
| **useNotifications** | P2 | Notification handling |
| **usePreviewDeployments** | P2 | Preview deploys |
| **useSentinelMetrics** | P2 | Sentinel data |
| **useServiceMetrics** | P2 | Service metrics |
| **useTeamActivity** | P2 | Team activity |
| **useTransfers** | P2 | Resource transfers |
| **useWebhooks** | P2 | Webhook management |
| **useAiChat** | P3 | AI chat |
| **useAiAnalytics** | P3 | AI usage |
| **useBilling** | P3 | Billing |
| **useCodeReview** | P3 | Code review |
| **useAutoScroll** | P3 | Already tested |
| All extended DB hooks | P3 | Clickhouse, Mongo, Redis |

---

## Implementation Strategy

### Phase 1: Core Models & Critical Paths (Target: 25% backend, 30% frontend)

**Backend:**
1. Unit tests for pure-logic model methods (scopes, accessors, mutators)
2. Feature tests for Application CRUD lifecycle
3. Feature tests for Server CRUD + validation
4. Feature tests for Service CRUD + compose parsing
5. Feature tests for Database CRUD (all 8 types)
6. Unit tests for EnvironmentVariableProtection, EnvironmentVariableAnalyzer traits
7. Unit tests for GenerateConfig action

**Frontend:**
1. Auth pages (Login, Register, ForgotPassword, ResetPassword)
2. Settings/Team management pages
3. Settings/Tokens page
4. Databases remaining pages (Overview, Settings, Backups, Import)
5. Servers/Settings pages
6. Services missing pages (Domains, Variables, Deployments)
7. Key components: Modal, ConfirmationModal, Tabs, Toast
8. Hooks: useLogStream, useGitBranches, useDatabaseDetails

### Phase 2: Jobs & API Controllers (Target: 40% backend, 40% frontend)

**Backend:**
1. Feature tests for ApplicationDeploymentJob (mock SSH/Docker)
2. Feature tests for ServerCheckJob, ServerManagerJob
3. Feature tests for DatabaseBackupJob, DatabaseRestoreJob
4. API controller tests for all CRUD endpoints
5. Feature tests for DeploymentApproval workflow
6. Policy tests for all uncovered policies

**Frontend:**
1. Sources pages (GitHub, GitLab, Bitbucket)
2. Storage pages (S3, Backups, Snapshots)
3. Volumes, Tags, Transfers, SharedVariables pages
4. Settings/Notifications subpages
5. Features/Projects/Tabs components
6. Deployment components
7. Remaining hooks

### Phase 3: Full Coverage Push (Target: 60% backend, 50% frontend)

**Backend:**
1. Remaining Actions (Create*, Start*, Stop*)
2. Deployment traits (unit test where possible, feature test rest)
3. Remaining jobs (notification, cleanup, monitoring)
4. Events, ViewComponents
5. Edge cases, error paths

**Frontend:**
1. Admin subpages
2. Activity, Observability, CronJobs pages
3. AiChat components
4. Animation components
5. Migration components
6. All remaining hooks and components

---

## Test Infrastructure Notes

### Backend
- **Unit tests:** Run anywhere, no DB needed. Use Mockery for models.
- **Feature tests:** MUST run in Docker (`docker exec saturn php artisan test`)
- **Coverage:** Requires PCOV extension + 4GB+ memory for full report
- **PHPStan:** Level 5 with baseline (2456 baselined errors)
- **Pint:** Run before every commit

### Frontend
- **Vitest 4.0.17** with jsdom environment
- **Coverage:** `@vitest/coverage-v8` installed
- **Test utils:** `tests/Frontend/utils/test-utils.tsx` with custom render
- **Mocks:** `tests/Frontend/mocks/` directory for shared mocks
- **Run:** `npm run test -- --run` (all) or `npm run test -- --run path/to/test`

### CI/CD
- GitHub Actions: `.github/workflows/deploy-to-vps.yml`
- Test job is `continue-on-error: true` (non-blocking)
- Should be changed to blocking once coverage reaches 40%+

---

## Estimated Effort

| Phase | Backend | Frontend | Total |
|-------|---------|----------|-------|
| Phase 1 | ~80 test files | ~40 test files | ~120 files |
| Phase 2 | ~60 test files | ~35 test files | ~95 files |
| Phase 3 | ~50 test files | ~30 test files | ~80 files |
| **Total** | **~190 test files** | **~105 test files** | **~295 files** |
